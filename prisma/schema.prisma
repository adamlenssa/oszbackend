generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model user {
  id           Int       @id @default(autoincrement())
  username     String    @unique
  passwordHash String
  firstName    String
  lastName     String
  email        String    @unique
  role         role      @default(listner)
  comment      comment[]
  likes        like[]
  songs        song[]
  ip ip[]
}

model artist {
  id        Int    @id @default(autoincrement())
  firstName String
  lastName  String
  fullName  String @unique
  songs     song[]
}

model song {
  id         Int       @id @default(autoincrement())
  songname   String
  singer     String
  link       String    @unique
  image  String? 
  uploadedBy Int
  type       type
  public     Boolean
  time       DateTime  @default(now())
  comment    comment[]
  likes      like[]
  artist     artist    @relation(fields: [singer], references: [fullName])
  user       user      @relation(fields: [uploadedBy], references: [id])

  @@index([singer], map: "song_singer_fkey")
  @@index([uploadedBy], map: "song_uploadedBy_fkey")
}

model like {
  id     Int  @id @default(autoincrement())
  songId Int
  userId Int
  song   song @relation(fields: [songId], references: [id])
  user   user @relation(fields: [userId], references: [id])

  @@index([songId], map: "like_songId_fkey")
  @@index([userId], map: "like_userId_fkey")
}

model comment {
  id      Int      @id @default(autoincrement())
  songId  Int
  userId  Int
  comment String
  time    DateTime @default(now())
  song    song     @relation(fields: [songId], references: [id])
  user    user     @relation(fields: [userId], references: [id])

  @@index([songId], map: "comment_songId_fkey")
  @@index([userId], map: "comment_userId_fkey")
}

model ip {
  id Int @id @default(autoincrement())
  userId Int 
  user user @relation(fields: [userId], references: [id])
}

enum role {
  admin
  listner
}

enum type {
  Shewa
  Wallaga
  Arsi
  Bale
  Jimma
  Wallo
  Hararghe
  Borana
  Guji
  Illubabor
  Karayuu
  Modern
  Oldies
}
